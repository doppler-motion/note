# 车道线识别

## 传统方法

1. 边缘检测+霍夫变换
    方法流程：彩色图像转灰度，模糊处理，边缘检测，霍夫变换
  这种方法一般能够检测出简单场景下的车辆目前行驶的两条车道线，以及偶尔的相邻车道（依赖前视相机的角度）。该方法可以利用霍夫变换的结果（线的斜率），进一步过滤出左右车道线。不过同时，该方法也依赖于边缘检测的结果，所以调参（边缘检测、霍夫变换）以及其他的trick（roi选取等等）是很重要的。

2. 颜色阈值
    方法流程：将图像转颜色空间（一般HSV），对新的color space中的各个通道设置阈值（大于阈值取值为1，小于取值为0），得到结果。
  该方法依赖于各通道的阈值的选取，只需要调整几个阈值参数，但个人认为该方法鲁棒性会较差，例如当前车辆前方的车辆可能会被全部置1。

3. 透视变换
    方法流程：获取透视变换矩阵，透视变换，车道线检测（1或者2）
  该方法的优点是将前视摄像头抓拍的图像转为鸟瞰图，能够检测到多条线。其关键在于透视变换矩阵的准确性（不考虑转换后的车道线检测），对于转换后的鸟瞰图，可以通过上述两种方式检测车道线。
  在实际场景中，传统方法的鲁棒性确实不行，除去光照和邻近车辆的影响外，车道中间的指示箭头和人行道也是此类算法很难处理的挑战。

> 参考：https://blog.csdn.net/liaojiacai/article/details/63685342

## 神经网络

### 简介

当前基于CNN的车道线检测方案主要分为三类：

> * 基于分割的车道线检测
>
>   > 基于分割的方案由于需要在整张图上进行逐像素的预测且没有将车道线当做一个完整单元，所以往往比较ineffective and time-consuming
>
> * 基于anchor的车道线检测
>
>   > 基于anchor的方案中，在一些复杂场景中的起点很难识别，这造成相对欠佳的性能表现
>
> * 基于曲线参数化拟合的车道线检测
>
>   > 基于参数化拟合的方案虽然回归更少的参数，但对于预测的参数较为敏感，如高阶系数的错误预测可能造成车道线形状的变化。尽管基于参数化的方案有更快的推理速度，但在精度上有一定的瓶颈。

车道线的表现形式

> a 输出类型：掩码、点集、矢量形式
>
> b实例化：每个车道线是否形成实例
>
> c 分类：是否对车道线进行分类（单白、双黄等）
>
> d 提前定义的参数：是否智能检测固定数量的车道线
>
> e 车道标记：是否对车道上的行车标记也进行了检测

神经网络推理到哪一步

> 图像分割方案 倾向于像素点的分类，该像素点是否属于车道线标识，并对标识类别进行推断
>
> 图像检测方案 倾向于抽象出分割边界线，在设定的一系列anchor中判断是否存在车道线以及回归车道线参数

### 不同的模型

#### LaneNet

> 这是将语义分割和对像素进行向量表示结合起来的 **多任务模型**，最后利用 **聚类** 完成对车道线的实例分割。

* 亮点

  >1. 语义分割：对像素进行二分类，判断像素属于车道线还是背景；
  >2. 对像素进行向量，Embedding，对像素进行嵌入式表示，把图像特征表示为嵌入空间种，特征之间的关系映射在嵌入空间
  >
  >3. 聚类，基于Mean-Shift算法实现的，把将两个分支的结果进行聚类，得到实例分割的结果。



#### CLRNet（跨层优化网络）

> 这个模型首先检测具有 **高级语义特征** 的车道，然后基于 **低级特征** 进行细化，充分利用车道检测中的高级和低级特征，提出了 **ROIGather** 来收集全局上下文信息，进一步增强了车道的特征表示。此外，设计了整体维度的Lane IoU loss 来约束整体车道线的回归精度。

* 亮点

  > 1. 提出一种 coarse-to-fine的机制，利用高层特征检出车道线，利用低层特征调节车道线位置。
  > 2. 提出RoIGather模块获取全局语境信息，提出Line IoU loss，把车道线作为一个整体来优化。



